(this["webpackJsonpall-clear"]=this["webpackJsonpall-clear"]||[]).push([[0],{50:function(e,t,n){},51:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var c=n(0),i=n.n(c),o=n(31),a=n.n(o),r=n(7),s=n(13),u=n(5),l=n(18),d="http://localhost:8088",j="users",h="app_user_id",b=n(1),O=function(){var e=Object(c.useState)({email:""}),t=Object(u.a)(e,2),n=t[0],i=t[1],o=Object(c.useState)(!1),a=Object(u.a)(o,2),O=a[0],f=a[1],m=Object(r.f)();return Object(b.jsxs)("main",{className:"container--login",children:[Object(b.jsxs)("dialog",{className:"dialog dialog--auth",open:O,children:[Object(b.jsx)("div",{children:"User does not exist"}),Object(b.jsx)("button",{className:"button--close",onClick:function(e){return f(!1)},children:"Close"})]}),Object(b.jsx)("section",{children:Object(b.jsxs)("form",{className:"form--login",onSubmit:function(e){e.preventDefault(),fetch("".concat(d,"/").concat(j,"?email=").concat(n.email)).then((function(e){return e.json()})).then((function(e){return!!e.length&&e[0]})).then((function(e){e?(sessionStorage.setItem(h,e.id),m.push("/")):f(!0)}))},children:[Object(b.jsx)("h1",{children:"Checkpoint"}),Object(b.jsx)("h2",{children:"Please sign in"}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{htmlFor:"inputEmail",children:" Email address "}),Object(b.jsx)("input",{type:"email",id:"email",className:"form-control",placeholder:"Email address",required:!0,autoFocus:!0,value:n.email,onChange:function(e){var t=Object(s.a)({},n);t[e.target.id]=e.target.value,i(t)}})]}),Object(b.jsx)("fieldset",{children:Object(b.jsx)("button",{type:"submit",children:"Sign in"})})]})}),Object(b.jsx)("section",{className:"link--register",children:Object(b.jsx)(l.b,{to:"/register",children:"Register for an account"})})]})},f=function(){var e=Object(c.useState)({firstName:"",lastName:"",email:""}),t=Object(u.a)(e,2),n=t[0],i=t[1],o=Object(c.useState)(!1),a=Object(u.a)(o,2),l=a[0],O=a[1],f=Object(r.f)(),m=function(e){var t=Object(s.a)({},n);t[e.target.id]=e.target.value,i(t)};return Object(b.jsxs)("main",{style:{textAlign:"center"},children:[Object(b.jsxs)("dialog",{className:"dialog dialog--password",open:l,children:[Object(b.jsx)("div",{children:"Account with that email address already exists"}),Object(b.jsx)("button",{className:"button--close",onClick:function(e){return O(!1)},children:"Close"})]}),Object(b.jsxs)("form",{className:"form--login",onSubmit:function(e){e.preventDefault(),fetch("".concat(d,"/").concat(j,"?email=").concat(n.email)).then((function(e){return e.json()})).then((function(e){return!!e.length})).then((function(e){e?O(!0):fetch("".concat(d,"/").concat(j),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n.email,firstName:n.firstName,lastName:n.lastName})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("id")&&(sessionStorage.setItem(h,e.id),f.push("/"))}))}))},children:[Object(b.jsx)("h1",{className:"h3 mb-3 font-weight-normal",children:"Please Register for Application Name"}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{htmlFor:"firstName",children:" First Name "}),Object(b.jsx)("input",{type:"text",name:"firstName",id:"firstName",className:"form-control",placeholder:"First name",required:!0,autoFocus:!0,value:n.firstName,onChange:m})]}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{htmlFor:"lastName",children:" Last Name "}),Object(b.jsx)("input",{type:"text",name:"lastName",id:"lastName",className:"form-control",placeholder:"Last name",required:!0,value:n.lastName,onChange:m})]}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{htmlFor:"inputEmail",children:" Email address "}),Object(b.jsx)("input",{type:"email",name:"email",id:"email",className:"form-control",placeholder:"Email address",required:!0,value:n.email,onChange:m})]}),Object(b.jsx)("fieldset",{children:Object(b.jsx)("button",{type:"submit",children:" Sign in "})})]})]})},m=n(34),x=n(28),g=n.n(x),p=n(33),v=Object(c.createContext)(),S=function(e){var t=Object(c.useContext)(C),n=t.getLatLong,i=t.getRoutePath,o=t.newRoute;Object(c.useEffect)((function(){if(o.origin){var e=[],t=[],c=[],s=[],l=o.origin,d=o.destination;i(o.origin,o.destination).then((function(t){return e=t.map((function(e){return n(e)})),Promise.all(e)})).then((function(e){e.forEach((function(e){var t=l.split(" "),n=d.split(" "),i=t.splice(-3,1),o=Object(u.a)(i,1)[0],a=n.splice(-3,1),r=Object(u.a)(a,1)[0],s=e.items.map((function(e){return e.title})).join("");s.toLowerCase().includes("".concat(o.toLowerCase()))||s.toLowerCase().includes("".concat(r.toLowerCase()))?c.push(e.items.find((function(e){return e.title.toLowerCase().includes("".concat(o.toLowerCase()))||e.title.toLowerCase().includes("".concat(r.toLowerCase()))}))):c.push(" ")}))})).then(Object(p.a)(g.a.mark((function e(){var n,i,l,d,j,h;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.map((function(e){return" "===e?t.push(""):t.push(Object.values(e.position))})),n=0;case 2:if(!(n<t.length)){e.next=18;break}if(""!==t[n]){e.next=10;break}return i={streetName:s[n],latLong:t[n],routeId:o.id,order:n+1},r(i),e.next=8,a(50);case 8:e.next=15;break;case 10:return l=Object(u.a)(t[n],2),d=l[0],j=l[1],h={streetName:s[n],latLong:d+", "+j,routeId:o.id,order:n+1},r(h),e.next=15,a(50);case 15:n++,e.next=2;break;case 18:case"end":return e.stop()}}),e)}))))}}),[o]);var a=function(e){return new Promise((function(t){setTimeout(t,e)}))},r=function(e){return fetch("http://localhost:8088/paths",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})};return Object(b.jsx)(v.Provider,{value:{getPathByRouteId:function(e){return fetch("http://localhost:8088/paths?routeId=".concat(e.id)).then((function(e){return e.json()}))}},children:e.children})},C=Object(c.createContext)(),N=function(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),i=n[0],o=n[1],a=Object(c.useState)({}),r=Object(u.a)(a,2),s=r[0],l=r[1],d=Object(c.useState)({}),j=Object(u.a)(d,2),h=(j[0],j[1],function(e){return fetch("https://geocode.search.hereapi.com/v1/geocode?q=".concat(e,"&apiKey=").concat(Object({NODE_ENV:"production",PUBLIC_URL:"/checkpoint",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API)).then((function(e){return e.json()}))}),O=function(e,t){return fetch("https://router.hereapi.com/v8/routes?transportMode=car&origin=".concat(Object.values(e),"&destination=").concat(Object.values(t),"&return=polyline,turnbyturnactions&apikey=").concat(Object({NODE_ENV:"production",PUBLIC_URL:"/checkpoint",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API)).then((function(e){return e.json()}))},f=function(e){return fetch("http://localhost:8088/routes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then(l).then(x).then((function(){return Object(b.jsx)(S,{})}))},x=function(){return fetch("https://kaitlinjkelley.github.io/data/open_data.geojson/routes").then((function(e){return e.json()})).then((function(e){return o(e)}))};return Object(b.jsx)(C.Provider,{value:{getLatLong:h,getDirections:O,addNewRoute:f,getRoutes:x,routes:i,getRouteById:function(e){return fetch("http://localhost:8088/routes/".concat(e,"?_embed=path")).then((function(e){return e.json()}))},deleteRoute:function(e){return fetch("http://localhost:8088/routes/".concat(e),{method:"DELETE"}).then(x)},updateRoute:function(e){return fetch("http://localhost:8088/routes/".concat(e.id),{method:"DELETE"}).then((function(){return f({name:e.name,origin:e.origin,destination:e.destination,userId:e.userId})}))},getRoutePath:function(e,t){var n={},c={};return h(e).then((function(e){return n=e.items[0].position})).then((function(){return h(t)})).then((function(e){return c=e.items[0].position})).then((function(){return O(n,c)})).then((function(t){return function(e,t){var n=e.routes[0].sections[0].turnByTurnActions.filter((function(e){return void 0!==e.nextRoad})),c=[];n.forEach((function(e){return e.nextRoad.name?c.push(e.nextRoad.name[0].value):c.push(e.nextRoad.number[0].value)}));var i=Object(m.a)(new Set(c)),o=[];if(t){var a=t.split(" ").splice(-2,1),r=Object(u.a)(a,1)[0];return i.forEach((function(e){o.push(e+" "+r)})),o}return i}(t,e)}))},newRoute:s},children:e.children})},R=Object(c.createContext)(),E=function(e){var t=Object(c.useState)({}),n=Object(u.a)(t,2),i=n[0],o=n[1],a=Object(c.useContext)(C),r=(a.getLatLong,a.getDirections,a.getRouteById,Object(c.useContext)(v).getPathByRouteId),s=function(e){return e=e.replace(/\s+/g,""),fetch("https://traffic.ls.hereapi.com/traffic/6.0/incidents.json?corridor=".concat(e,"20&apiKey=").concat(Object({NODE_ENV:"production",PUBLIC_URL:"/checkpoint",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API)).then((function(e){if(e.ok)return console.log("got a good response",e),e.json();console.log("you don't want that response")})).then((function(e){o(e)}))};return Object(b.jsx)(R.Provider,{value:{getIncidentAndLocation:function(e){return r(e).then((function(e){var t="";return e.forEach((function(e){return""!==e.latLong?t=t+e.latLong+";":t})),s(t)}))},incidents:i},children:e.children})},_=n(16),y=n(20),T=n(57),I=(n(29),n(50),function(e){var t=e.routeObj,n=Object(c.useContext)(R),i=n.getIncidentAndLocation,o=n.incidents,a=Object(c.useContext)(C),r=a.deleteRoute,l=a.getRouteById,d=a.updateRoute,j=a.getRoutePath,h=Object(c.useState)([]),O=Object(u.a)(h,2),f=O[0],m=O[1],x=Object(c.useState)(0),g=Object(u.a)(x,2),p=g[0],v=g[1],S=Object(c.useState)(Object(b.jsx)("div",{})),N=Object(u.a)(S,2),E=N[0],I=N[1],P=Object(c.useState)(!1),F=Object(u.a)(P,2),L=F[0],k=F[1],w=Object(c.useState)({}),A=Object(u.a)(w,2),D=A[0],Z=A[1],U=Object(c.useState)(!1),B=Object(u.a)(U,2),H=B[0],K=B[1],q=Object(c.useState)([]),W=Object(u.a)(q,2),M=W[0],J=W[1];Object(c.useEffect)((function(){var e;m(null===o||void 0===o||null===(e=o.TRAFFICITEMS)||void 0===e?void 0:e.TRAFFICITEM)}),[o]),Object(c.useEffect)((function(){I(function(){if(p===t.id)return f?Object(b.jsxs)("div",{className:"incidentMessage",children:[Object(b.jsx)("h5",{children:"Traffic Incidents"})," ",f.map((function(e){return Object(b.jsx)(y.a.Text,{children:null===e||void 0===e?void 0:e.TRAFFICITEMDESCRIPTION[0].content},Math.random())}))]}):Object(b.jsx)(y.a.Text,{className:"incidentMessage",children:"All clear! There are no incidents blocking your route"})}())}),[p]);var V=function(e){var t=Object(s.a)({},D);t[e.target.id]=e.target.value,Z(t)};Object(c.useEffect)((function(){var e,t;(null===(e=D.origin)||void 0===e?void 0:e.length)>15&&(null===(t=D.destination)||void 0===t?void 0:t.length)>15?K(!0):K(!1)}),[D]);return Object(b.jsxs)(y.a,{className:"savedRoutes__cards--routeCard",children:[L?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"allEditFields",children:[Object(b.jsx)("legend",{children:"Route Name"}),Object(b.jsx)("input",{id:"name",type:"text",value:D.name,onChange:function(e){return V(e)}}),Object(b.jsxs)("div",{className:"legends",children:[Object(b.jsx)("legend",{children:"Origin"}),Object(b.jsx)("legend",{children:"Destination"})]}),Object(b.jsxs)("div",{className:"addressEditFields",children:[Object(b.jsx)("textarea",{id:"origin",type:"text",value:D.origin,onChange:function(e){return V(e)}}),Object(b.jsx)("textarea",{id:"destination",type:"text",value:D.destination,onChange:function(e){return V(e)}})]})]}),Object(b.jsxs)(y.a.Body,{className:"newRoute__path",children:[Object(b.jsx)("h3",{children:"Your Route Path"}),Object(b.jsx)("p",{className:"editedRoutePath",children:M.join(" to ")}),Object(b.jsx)(_.a,{className:"route button",onClick:function(){return function(){var e=Object(s.a)({},D);j(e.origin,e.destination).then((function(e){return J(e)}))}()},children:"View Route Path"})]})]}):Object(b.jsx)(y.a.Title,{children:t.name}),L?"":Object(b.jsxs)(b.Fragment,{children:[E,Object(b.jsx)(_.a,{className:"traffic button",id:t.id,onClick:function(e){!function(e){i(t).then((function(){v(parseInt(e.target.id))}))}(e)},children:"Check Traffic"})]}),Object(b.jsxs)(T.a,{"aria-label":"First group",children:[L?Object(b.jsx)(_.a,{className:"save button",disabled:!H,onClick:function(){d(D),J([]),k(!1)},id:"".concat(t.id),children:"Save Changes"}):Object(b.jsx)(_.a,{className:"edit button",onClick:function(){l(t.id).then((function(e){return Z(e)})),k(!0)},id:"".concat(t.id),children:"Edit"}),Object(b.jsx)(_.a,{className:"delete button",onClick:function(){r(t.id)},children:"Delete Route"})]})]})}),P=n(19),F=n(11),L=(n(51),function(){var e,t=Object(c.useContext)(C),n=t.addNewRoute,i=t.getRoutePath,o=Object(c.useState)(!1),a=Object(u.a)(o,2),r=a[0],l=a[1],d=Object(c.useState)(["Don't forget to check your path before clicking Save!"]),j=Object(u.a)(d,2),O=j[0],f=j[1],m=Object(c.useState)({}),x=Object(u.a)(m,2),g=x[0],p=x[1],v=Object(c.useState)({name:"",originStreet:"",originCSZ:"",destinationStreet:"",destinationCSZ:""}),S=Object(u.a)(v,2),N=S[0],R=S[1],E=function(e){var t=Object(s.a)({},N);t[e.target.name]=e.target.value,R(t),!1===Object.values(t).includes("")?l(!0):l(!1)};return Object(c.useEffect)((function(){var e=parseInt(sessionStorage.getItem(h)),t={name:N.name,origin:N.originStreet+" "+N.originCSZ,destination:N.destinationStreet+" "+N.destinationCSZ,userId:e};p(t),r&&i(t.origin,t.destination).then((function(e){return f(e)}))}),[N]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"formsAndInput",children:[Object(b.jsxs)("fieldset",{className:"newRoute__forms--title",children:[Object(b.jsx)("legend",{children:"Route Name"}),Object(b.jsx)(F.a.Control,{type:"text",name:"name",value:N.name,placeholder:"Route Name (ex. Home to Work)",onChange:function(e){return E(e)},required:!0})]}),Object(b.jsxs)("div",{className:"newRoute__forms",children:[Object(b.jsxs)(F.a,{className:"newRoute__forms--origin",children:[Object(b.jsx)("legend",{children:"Origin"}),Object(b.jsx)("fieldset",{children:Object(b.jsx)(F.a.Control,{placeholder:"Street",type:"text",name:"originStreet",value:N.originStreet,onChange:function(e){return E(e)},required:!0})}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{htmlFor:"originCSZ"}),Object(b.jsx)(F.a.Control,{placeholder:"City, State Zip",type:"text",name:"originCSZ",value:N.originCSZ,onChange:function(e){return E(e)},required:!0})]})]}),Object(b.jsxs)(F.a,{className:"newRoute__forms--destination",children:[Object(b.jsx)("legend",{children:"Destination"}),Object(b.jsx)("fieldset",{children:Object(b.jsx)(F.a.Control,{placeholder:"Street",type:"text",name:"destinationStreet",value:N.destinationStreet,onChange:function(e){return E(e)},required:!0})}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{htmlFor:"destinationCSZ"}),Object(b.jsx)(F.a.Control,{placeholder:"City, State Zip",type:"text",name:"destinationCSZ",value:N.destinationCSZ,onChange:function(e){return E(e)},required:!0})]})]})]})]}),Object(b.jsxs)("div",{className:"newRoute__path",children:[Object(b.jsx)(y.a.Title,{children:"Your Route Path"}),O.join(" to ")]}),Object(b.jsx)("button",(e={className:"btn--saveRoute",type:"submit",disabled:!r},Object(P.a)(e,"className","save button"),Object(P.a)(e,"onClick",(function(){return n(g),R({name:"",originStreet:"",originCSZ:"",destinationStreet:"",destinationCSZ:""}),f([]),void l(!1)})),Object(P.a)(e,"children","Save Route"),e))]})}),k=(n(53),function(){var e=Object(c.useContext)(C),t=e.routes,n=e.getRoutes,i=Object(c.useState)([]),o=Object(u.a)(i,2),a=o[0],s=o[1],l=Object(r.f)();Object(c.useEffect)((function(){n()}),[]),Object(c.useEffect)((function(){var e=parseInt(sessionStorage.getItem(h)),n=t.filter((function(t){return t.userId===e}));s(n)}),[t]);return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return l.push("/edit-profile")},children:"Edit Profile Info"}),Object(b.jsx)("h1",{children:"Checkpoint"}),Object(b.jsx)("button",{className:"logout",onClick:function(){return sessionStorage.removeItem("app_user_id"),void l.push("/")},children:"Logout"}),Object(b.jsxs)("section",{className:"savedRoutes",children:[Object(b.jsx)("h2",{children:"Saved Routes"}),Object(b.jsx)("p",{className:"recheckMessage",children:"Traffic Incidents are updated periodically, so you may need to Check Traffic again if you're logged in for an extended period"}),Object(b.jsx)("div",{className:"savedRoutes__cards",children:a.map((function(e){return Object(b.jsx)(I,{routeObj:e},e.id)}))})]}),Object(b.jsxs)("div",{className:"newRoute",children:[Object(b.jsx)("h2",{children:"New Route"}),Object(b.jsx)("div",{className:"newRoute__content",children:Object(b.jsx)(L,{})})]})]})}),w=Object(c.createContext)(),A=function(e){var t=Object(c.useState)({}),n=Object(u.a)(t,2),i=n[0],o=n[1],a=sessionStorage.getItem(h);return Object(b.jsx)(w.Provider,{value:{getLoggedInUserObject:function(){return fetch("http://localhost:8088/users/".concat(a)).then((function(e){return e.json()})).then(o)},userObject:i,updateUser:function(e){return fetch("http://localhost:8088/users/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},children:e.children})},D=(n(54),function(){var e=Object(c.useContext)(w),t=e.getLoggedInUserObject,n=e.userObject,i=e.updateUser,o=Object(r.f)(),a=Object(c.useState)({}),l=Object(u.a)(a,2),d=l[0],j=l[1];Object(c.useEffect)((function(){t()}),[]),Object(c.useEffect)((function(){j(n)}),[n]);var h=function(e){var t=Object(s.a)({},d);t[e.target.name]=e.target.value,j(t)};return Object(b.jsxs)(F.a,{id:"modal",children:[Object(b.jsx)("h3",{id:"userEditHeader",children:"User Profile Information"}),Object(b.jsx)("legend",{htmlFor:"firstName",children:"First Name"}),Object(b.jsx)(F.a.Control,{name:"firstName",type:"text",value:"".concat(d.firstName),onChange:function(e){return h(e)}}),Object(b.jsx)("legend",{htmlFor:"lastName",children:"Last Name"}),Object(b.jsx)(F.a.Control,{name:"lastName",type:"text",value:"".concat(d.lastName),onChange:function(e){return h(e)}}),Object(b.jsx)("legend",{htmlFor:"email",children:"Email"}),Object(b.jsx)(F.a.Control,{name:"email",type:"text",value:"".concat(d.email),onChange:function(e){return h(e)}}),Object(b.jsx)(_.a,{id:"userEditSave",onClick:function(){return i(d),void o.push("/")},children:"Save Changes"})]})}),Z=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(r.b,{render:function(){return sessionStorage.getItem(h)?Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(A,{children:Object(b.jsx)(N,{children:Object(b.jsx)(S,{children:Object(b.jsxs)(E,{children:[Object(b.jsx)(r.b,{exact:!0,path:"/",children:Object(b.jsx)(k,{})}),Object(b.jsx)(r.b,{exact:!0,path:"/edit-profile",children:Object(b.jsx)(D,{})})]})})})})}):Object(b.jsx)(r.a,{to:"/login"})}}),Object(b.jsx)(r.b,{path:"/login",children:Object(b.jsx)(O,{})}),Object(b.jsx)(r.b,{path:"/register",children:Object(b.jsx)(f,{})})]})},U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,58)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,o=t.getLCP,a=t.getTTFB;n(e),c(e),i(e),o(e),a(e)}))};n(55);a.a.render(Object(b.jsx)(i.a.StrictMode,{children:Object(b.jsx)(l.a,{children:Object(b.jsx)(Z,{})})}),document.getElementById("root")),U()}},[[56,1,2]]]);
//# sourceMappingURL=main.33899234.chunk.js.map